MODULES.jobs={},MODULES.jobs.scientistRatio=25,MODULES.jobs.scientistRatio2=10,MODULES.jobs.magmamancerRatio=0.1,MODULES.jobs.autoRatio6=[1,11,12],MODULES.jobs.autoRatio5=[1,2,22],MODULES.jobs.autoRatio4=[1,1.2,10],MODULES.jobs.autoRatio3=[3,1,4],MODULES.jobs.autoRatio2=[3,3.1,5],MODULES.jobs.autoRatio1=[1,1.1,1.2],MODULES.jobs.customRatio;
function safeBuyJob(a,b){if(!Number.isFinite(b)||0===b||'undefined'==typeof b||Number.isNaN(b))return!1;var e,c=preBuy2(),d=Math.ceil(game.resources.trimps.realMax()/2)-game.resources.trimps.employed;return 0>b?(b=Math.abs(b),game.global.firing=!0,game.global.buyAmt=b,e=!0):(game.global.firing=!1,game.global.buyAmt=b,e=canAffordJob(a,!1)&&0<d,!e&&(game.global.buyAmt='Max',game.global.maxSplit=1,e=canAffordJob(a,!1)&&0<d)),e&&(debug((game.global.firing?'Firing ':'Hiring ')+prettify(game.global.buyAmt)+' '+a+'s','jobs','*users'),buyJob(a,!0,!0)),postBuy2(c),!0}
function safeFireJob(a,b){var c=game.jobs[a].owned;if(0==c||0==b)return 0;var d=c,e=1;if(null!=b&&(e=b),!Number.isFinite(c))for(;c==d;)d-=e,e*=2;var f=preBuy2();game.global.firing=!0;for(var g=Math.ceil(game.resources.trimps.realMax()/2)-game.resources.trimps.employed;1<=e&&g==Math.ceil(game.resources.trimps.realMax()/2)-game.resources.trimps.employed;)game.global.buyAmt=e,buyJob(a,!0,!0),e*=2;return postBuy2(f),e/2}
function buyJobs(){function d(D,E){f=Math.ceil(game.resources.trimps.realMax()/2)-game.resources.trimps.employed,null==E&&(E=1),canAffordJob(D,!1,E)&&!game.jobs[D].locked&&(f<E&&(r=safeFireJob('Farmer')),safeBuyJob(D,E))}function e(D,E){if(!game.jobs[D].locked&&!breedFire){f=Math.ceil(game.resources.trimps.realMax()/2)-game.resources.trimps.employed,h=f+game.jobs.Farmer.owned+game.jobs.Miner.owned+game.jobs.Lumberjack.owned;var F=Math.floor(E/l*h)-game.jobs[D].owned-r,G=Math.floor(game.resources.trimps.owned-game.resources.trimps.employed),H=F<=G?F:G;if(0!=H){if(!0==getPageSetting('buynojobsc')&&('Watch'==game.global.challengeActive||'Trapper'==game.global.challengeActive))return;safeBuyJob(D,H)}return!0}return!1}var f=Math.ceil(game.resources.trimps.realMax()/2)-game.resources.trimps.employed,g=game.resources.trimps.owned-game.resources.trimps.employed,h=f+game.jobs.Farmer.owned+game.jobs.Miner.owned+game.jobs.Lumberjack.owned,i=parseInt(getPageSetting('FarmerRatio')),j=parseInt(getPageSetting('LumberjackRatio')),k=parseInt(getPageSetting('MinerRatio')),l=i+j+k,m=l/MODULES.jobs.scientistRatio;if(100>game.jobs.Farmer.owned&&(m=l/MODULES.jobs.scientistRatio2),1==game.global.world&&5e3>=game.global.totalHeliumEarned)return void(game.resources.trimps.owned<0.9*game.resources.trimps.realMax()&&(5<game.resources.food.owned&&0<f&&(game.jobs.Farmer.owned==game.jobs.Lumberjack.owned?safeBuyJob('Farmer',1):game.jobs.Farmer.owned>game.jobs.Lumberjack.owned&&!game.jobs.Lumberjack.locked&&safeBuyJob('Lumberjack',1)),f=Math.ceil(game.resources.trimps.realMax()/2)-game.resources.trimps.employed,20<game.resources.food.owned&&0<f&&game.jobs.Farmer.owned==game.jobs.Lumberjack.owned&&!game.jobs.Miner.locked&&safeBuyJob('Miner',1)));if(0==game.jobs.Farmer.owned&&game.jobs.Lumberjack.locked&&0<f?safeBuyJob('Farmer',1):0!=getPageSetting('MaxScientists')&&10>game.jobs.Scientist.owned&&100<scienceNeeded&&0<f&&10<=game.jobs.Farmer.owned&&safeBuyJob('Scientist',1),f=Math.ceil(game.resources.trimps.realMax()/2)-game.resources.trimps.employed,h=f+game.jobs.Farmer.owned+game.jobs.Miner.owned+game.jobs.Lumberjack.owned,'Watch'!=game.global.challengeActive){var g=game.resources.trimps.owned-game.resources.trimps.employed;if('Trapper'!=game.global.challengeActive&&game.resources.trimps.owned<0.9*game.resources.trimps.realMax()&&!breedFire)return void(g>0.33*game.resources.trimps.realMax()&&(f=Math.ceil(game.resources.trimps.realMax()/2)-game.resources.trimps.employed,0<f&&3e5>=game.resources.trimps.realMax()&&(!0==getPageSetting('buynojobsc')&&('Watch'!=game.global.challengeActive||'Trapper'!=game.global.challengeActive)||!1==getPageSetting('buynojobsc')&&('Watch'!=game.global.challengeActive||'Trapper'!=game.global.challengeActive)||!1==getPageSetting('buynojobsc')&&('Watch'==game.global.challengeActive||'Trapper'==game.global.challengeActive))&&(safeBuyJob('Miner',1),safeBuyJob('Farmer',1),safeBuyJob('Lumberjack',1))))}else if(m=l/MODULES.jobs.scientistRatio2,game.resources.trimps.owned<0.9*game.resources.trimps.realMax()&&!breedFire){var o=Math.floor(m/l*h-game.jobs.Scientist.owned);if(game.jobs.Scientist.owned<o&&game.resources.trimps.owned>0.1*game.resources.trimps.realMax()){var p=o-game.jobs.Scientist.owned,q=Math.floor(game.resources.trimps.owned-game.resources.trimps.employed);0<o&&0<f&&(getPageSetting('MaxScientists')>game.jobs.Scientist.owned||-1==getPageSetting('MaxScientists'))&&safeBuyJob('Scientist',p<=q?p:q)}else return}var r=0;f=Math.ceil(game.resources.trimps.realMax()/2)-game.resources.trimps.employed,h=f+game.jobs.Farmer.owned+game.jobs.Miner.owned+game.jobs.Lumberjack.owned;var s=getPageSetting('MaxScientists');if(0!=s&&!game.jobs.Scientist.locked&&!breedFire){var o=Math.floor(m/l*h)-game.jobs.Scientist.owned-r,t=game.jobs.Scientist.owned;if(0<o&&0<f&&(s>t||-1==s)){var u=s-t;-1==s?u=o:0>u&&(u=0),o>u&&(o=u),safeBuyJob('Scientist',o)}}if((getPageSetting('MaxTrainers')>game.jobs.Trainer.owned||-1==getPageSetting('MaxTrainers'))&&d('Trainer'),(getPageSetting('MaxExplorers')>game.jobs.Explorer.owned||-1==getPageSetting('MaxExplorers'))&&d('Explorer'),e('Farmer',i),!e('Miner',k)&&breedFire&&0===game.global.turkimpTimer&&(!0==getPageSetting('buynojobsc')&&('Watch'!=game.global.challengeActive||'Trapper'!=game.global.challengeActive)||!1==getPageSetting('buynojobsc')&&('Watch'!=game.global.challengeActive||'Trapper'!=game.global.challengeActive)||!1==getPageSetting('buynojobsc')&&('Watch'==game.global.challengeActive||'Trapper'==game.global.challengeActive))&&safeBuyJob('Miner',-1*game.jobs.Miner.owned),!e('Lumberjack',j)&&breedFire&&(!0==getPageSetting('buynojobsc')&&('Watch'!=game.global.challengeActive||'Trapper'!=game.global.challengeActive)||!1==getPageSetting('buynojobsc')&&('Watch'!=game.global.challengeActive||'Trapper'!=game.global.challengeActive)||!1==getPageSetting('buynojobsc')&&('Watch'==game.global.challengeActive||'Trapper'==game.global.challengeActive))&&safeBuyJob('Lumberjack',-1*game.jobs.Lumberjack.owned),!game.jobs.Magmamancer.locked){var v=Math.floor((new Date().getTime()-game.global.zoneStarted)/6e4);game.talents.magmamancer.purchased&&(v+=5);var w=Math.floor(v/10);if(getPageSetting('AutoMagmamancers')&&w>tierMagmamancers){var x=preBuy2();game.global.firing=!1,game.global.buyAmt='Max',game.global.maxSplit=MODULES.jobs.magmamancerRatio;var y=calculateMaxAfford(game.jobs.Magmamancer,!1,!1,!0),z=1/MODULES.jobs.magmamancerRatio;y*=z,game.jobs.Farmer.owned>y?safeFireJob('Farmer',y):game.jobs.Lumberjack.owned>y?safeFireJob('Lumberjack',y):game.jobs.Miner.owned>y&&safeFireJob('Miner',y),game.global.firing=!1,game.global.buyAmt='Max',game.global.maxSplit=MODULES.jobs.magmamancerRatio,buyJob('Magmamancer',!0,!0),postBuy2(x),debug('Bought '+y/z+' Magmamancers. Total Owned: '+game.jobs.Magmamancer.owned,'magmite','*users'),tierMagmamancers+=1}else w<tierMagmamancers&&(tierMagmamancers=0);if(2>game.resources.trimps.owned-game.resources.trimps.employed){var A=2<game.jobs.Farmer.owned;A&&safeFireJob('Farmer',2);var B=2<game.jobs.Lumberjack.owned;B&&safeFireJob('Lumberjack',2);var C=2<game.jobs.Miner.owned;C&&safeFireJob('Miner',2),(A||B||C)&&debug('Job Protection Triggered, Number Rounding Error: [f,l,m]= '+A+' '+B+' '+C,'other')}}}
var tierMagmamancers = 0;
function workerRatios(){var a;a=MODULES.jobs.customRatio?MODULES.jobs.customRatio:3e3<game.buildings.Tribute.owned&&mutations.Magma.active()?MODULES.jobs.autoRatio5:1500<game.buildings.Tribute.owned?MODULES.jobs.autoRatio5:1e3<game.buildings.Tribute.owned?MODULES.jobs.autoRatio4:3e6<game.resources.trimps.realMax()?MODULES.jobs.autoRatio3:3e5<game.resources.trimps.realMax()?MODULES.jobs.autoRatio2:MODULES.jobs.autoRatio1,"Watch"==game.global.challengeActive?a=MODULES.jobs.autoRatio1:"Metal"==game.global.challengeActive&&(a=[4,5,0]),setPageSetting("FarmerRatio",a[0]),setPageSetting("LumberjackRatio",a[1]),setPageSetting("MinerRatio",a[2])}
